<nav class="navbar">
  <div class="nav-left">
    <h2>Teacher Student Management System</h2>
  </div>
  <div class="nav-right">
    <button class="btn teacher-btn" routerLink="/teacher">Teacher</button>
    <button class="btn student-btn" routerLink="/student">Student</button>
    <button class="btn logout-btn" (click)="onLogOut()">Log Out</button>
  </div>
</nav>

<div class="body">

  <h1>Student Panel</h1>

  <button class="btn add" (click)="toggleAddStudent()">Add New Student</button>

  @if (showStudentTable) {
    <div class="search-box">
      <label for="Search">Search anyone? Type here</label>
      <input type="search" [(ngModel)]="searchText" class="search-box" placeholder="Search Box">
    </div>
  }

  @if (showAddStudent) {
    <div class="form-wrapper">
      <div class="form-container">
        <h2>{{ isEditMode ? 'Edit Student Information' : 'Add Student Information' }}</h2>
        <form>
          <div class="form-group">
            <label for="studentName">Full Name</label>
            <input type="text" id="studentName" [(ngModel)]="students.name" name="name" placeholder="Enter student name" required>
          </div>

          <div class="form-group">
            <label for="studentEmail">Email Address</label>
            <input type="email" id="studentEmail" [(ngModel)]="students.email" name="email" placeholder="example@mail.com" required>
          </div>

          <div class="form-group">
            <label for="studentDepartment">Department</label>
            <input type="text" id="studentDepartment" [(ngModel)]="students.department" name="department" placeholder="Enter department" required>
          </div>

          <button type="submit" class="btn" (click)="onSubmit()">{{isEditMode ? 'Update Student' : 'Save Student' }}</button>
        </form>
      </div>
    </div>
  }

  @if (showViewStudent) {
    <div class="form-wrapper">
      <div class="form-container">
        <h2>Student Details</h2>
        <form>
          <div class="form-group">
            <label for="viewName">Full Name</label>
            <input type="text" id="viewName" [(ngModel)]="selectedStudent.name" name="name" readonly>
          </div>

          <div class="form-group">
            <label for="viewEmail">Email Address</label>
            <input type="email" id="viewEmail" [(ngModel)]="selectedStudent.email" name="email" readonly>
          </div>

          <div class="form-group">
            <label for="viewDepartment">Department</label>
            <input type="text" id="viewDepartment" [(ngModel)]="selectedStudent.department" name="department" readonly>
          </div>

          <button type="button" class="btn close-btn" (click)="closeViewStudent()">Close</button>
        </form>
      </div>
    </div>
  }

  @if (showStudentTable) {
    <div class="table-wrapper">
      <table class="student-table">
        <thead>
          <tr>
            <th>SL No</th>
            <th>Full Name</th>
            <th>Email</th>
            <th>Department</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          @for (student of studentList | searchFilter: searchText | paginate: {itemsPerPage: 5, currentPage: page}; track student;) {
          <tr>
            <td>{{ (page - 1) * 5 + $index + 1 }}</td>
            <td>{{ student.name }}</td>
            <td>{{ student.email }}</td>
            <td>{{ student.department }}</td>
            <td>
              <button class="btn-action edit-btn" (click)="onEdit(student, (page - 1) * 5 + $index)">Edit</button>
              <button class="btn-action delete-btn" (click)="onDelete((page - 1) * 5 + $index)">Delete</button>
              <button class="btn-action view-btn" (click)="onView(student)">View</button>
            </td>
          </tr>
          }
        </tbody>
      </table>
    </div>
    <pagination-controls
      (pageChange)="page = $event"
      [autoHide]="true"
      previousLabel="Prev"
      nextLabel="Next">
    </pagination-controls>
  }
</div>

@if (showDeleteModal) {
  <div class="modal-overlay" (click)="closeDeleteModal()">
    <div class="modal-content">
      <div class="modal-body">
        <p>Are you sure you want to delete this student?</p>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" (click)="closeDeleteModal()">Cancel</button>
        <button class="btn btn-danger" (click)="confirmDelete()">Delete</button>
      </div>
    </div>
  </div>
}
